{"version":3,"sources":["../../../../../lib/xlsx/xform/sheet/sheet-properties-xform.js"],"names":["utils","require","BaseXform","ColorXform","PageSetupPropertiesXform","OutlinePropertiesXform","SheetPropertiesXform","module","exports","map","tabColor","pageSetUpPr","outlinePr","inherits","tag","render","xmlStream","model","addRollback","openNode","inner","pageSetup","outlineProperties","closeNode","commit","rollback","parseOpen","node","parser","name","reset","parseText","text","parseClose","undefined"],"mappings":"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","sourcesContent":["'use strict';\n\nconst utils = require('../../../utils/utils');\nconst BaseXform = require('../base-xform');\nconst ColorXform = require('../style/color-xform');\nconst PageSetupPropertiesXform = require('./page-setup-properties-xform');\nconst OutlinePropertiesXform = require('./outline-properties-xform');\n\nconst SheetPropertiesXform = (module.exports = function() {\n  this.map = {\n    tabColor: new ColorXform('tabColor'),\n    pageSetUpPr: new PageSetupPropertiesXform(),\n    outlinePr: new OutlinePropertiesXform(),\n  };\n});\n\nutils.inherits(SheetPropertiesXform, BaseXform, {\n  get tag() {\n    return 'sheetPr';\n  },\n\n  render(xmlStream, model) {\n    if (model) {\n      xmlStream.addRollback();\n      xmlStream.openNode('sheetPr');\n\n      let inner = false;\n      inner = this.map.tabColor.render(xmlStream, model.tabColor) || inner;\n      inner = this.map.pageSetUpPr.render(xmlStream, model.pageSetup) || inner;\n      inner = this.map.outlinePr.render(xmlStream, model.outlineProperties) || inner;\n\n      if (inner) {\n        xmlStream.closeNode();\n        xmlStream.commit();\n      } else {\n        xmlStream.rollback();\n      }\n    }\n  },\n\n  parseOpen(node) {\n    if (this.parser) {\n      this.parser.parseOpen(node);\n      return true;\n    }\n    if (node.name === this.tag) {\n      this.reset();\n      return true;\n    }\n    if (this.map[node.name]) {\n      this.parser = this.map[node.name];\n      this.parser.parseOpen(node);\n      return true;\n    }\n    return false;\n  },\n  parseText(text) {\n    if (this.parser) {\n      this.parser.parseText(text);\n      return true;\n    }\n    return false;\n  },\n  parseClose(name) {\n    if (this.parser) {\n      if (!this.parser.parseClose(name)) {\n        this.parser = undefined;\n      }\n      return true;\n    }\n    if (this.map.tabColor.model || this.map.pageSetUpPr.model || this.map.outlinePr.model) {\n      this.model = {};\n      if (this.map.tabColor.model) {\n        this.model.tabColor = this.map.tabColor.model;\n      }\n      if (this.map.pageSetUpPr.model) {\n        this.model.pageSetup = this.map.pageSetUpPr.model;\n      }\n      if (this.map.outlinePr.model) {\n        this.model.outlineProperties = this.map.outlinePr.model;\n      }\n    } else {\n      this.model = null;\n    }\n    return false;\n  },\n});\n"],"file":"sheet-properties-xform.js"}