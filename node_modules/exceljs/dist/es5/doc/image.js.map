{"version":3,"sources":["../../../lib/doc/image.js"],"names":["colCache","require","Anchor","module","exports","worksheet","model","type","imageId","range","tl","br","ext","Error","decoded","decode","col","left","row","top","right","bottom","editAs"],"mappings":";;;;;;;;AAAA,IAAMA,QAAQ,GAAGC,OAAO,CAAC,oBAAD,CAAxB;;AACA,IAAMC,MAAM,GAAGD,OAAO,CAAC,UAAD,CAAtB;;AAEAE,MAAM,CAACC,OAAP;AAAA;AAAA;AACE,iBAAYC,SAAZ,EAAuBC,KAAvB,EAA8B;AAAA;;AAC5B,SAAKD,SAAL,GAAiBA,SAAjB;AACA,SAAKC,KAAL,GAAaA,KAAb;AACD;;AAJH;AAAA;AAAA,wBAMc;AACV,cAAQ,KAAKC,IAAb;AACE,aAAK,YAAL;AACE,iBAAO;AACLA,YAAAA,IAAI,EAAE,KAAKA,IADN;AAELC,YAAAA,OAAO,EAAE,KAAKA;AAFT,WAAP;;AAIF,aAAK,OAAL;AACE,iBAAO;AACLD,YAAAA,IAAI,EAAE,KAAKA,IADN;AAELC,YAAAA,OAAO,EAAE,KAAKA,OAFT;AAGLC,YAAAA,KAAK,EAAE;AACLC,cAAAA,EAAE,EAAE,KAAKD,KAAL,CAAWC,EAAX,CAAcJ,KADb;AAELK,cAAAA,EAAE,EAAE,KAAKF,KAAL,CAAWE,EAAX,IAAiB,KAAKF,KAAL,CAAWE,EAAX,CAAcL,KAF9B;AAGLM,cAAAA,GAAG,EAAE,KAAKH,KAAL,CAAWG;AAHX;AAHF,WAAP;;AASF;AACE,gBAAM,IAAIC,KAAJ,CAAU,oBAAV,CAAN;AAjBJ;AAmBD,KA1BH;AAAA,4BA4BsC;AAAA,UAAxBN,IAAwB,QAAxBA,IAAwB;AAAA,UAAlBC,OAAkB,QAAlBA,OAAkB;AAAA,UAATC,KAAS,QAATA,KAAS;AAClC,WAAKF,IAAL,GAAYA,IAAZ;AACA,WAAKC,OAAL,GAAeA,OAAf;;AAEA,UAAID,IAAI,KAAK,OAAb,EAAsB;AACpB,YAAI,OAAOE,KAAP,KAAiB,QAArB,EAA+B;AAC7B,cAAMK,OAAO,GAAGd,QAAQ,CAACe,MAAT,CAAgBN,KAAhB,CAAhB;AACA,eAAKA,KAAL,GAAa;AACXC,YAAAA,EAAE,EAAE,IAAIR,MAAJ,CAAW,KAAKG,SAAhB,EAA2B;AAAEW,cAAAA,GAAG,EAAEF,OAAO,CAACG,IAAf;AAAqBC,cAAAA,GAAG,EAAEJ,OAAO,CAACK;AAAlC,aAA3B,EAAoE,CAAC,CAArE,CADO;AAEXR,YAAAA,EAAE,EAAE,IAAIT,MAAJ,CAAW,KAAKG,SAAhB,EAA2B;AAAEW,cAAAA,GAAG,EAAEF,OAAO,CAACM,KAAf;AAAsBF,cAAAA,GAAG,EAAEJ,OAAO,CAACO;AAAnC,aAA3B,EAAwE,CAAxE,CAFO;AAGXC,YAAAA,MAAM,EAAE;AAHG,WAAb;AAKD,SAPD,MAOO;AACL,eAAKb,KAAL,GAAa;AACXC,YAAAA,EAAE,EAAE,IAAIR,MAAJ,CAAW,KAAKG,SAAhB,EAA2BI,KAAK,CAACC,EAAjC,EAAqC,CAArC,CADO;AAEXC,YAAAA,EAAE,EAAEF,KAAK,CAACE,EAAN,IAAY,IAAIT,MAAJ,CAAW,KAAKG,SAAhB,EAA2BI,KAAK,CAACE,EAAjC,EAAqC,CAArC,CAFL;AAGXC,YAAAA,GAAG,EAAEH,KAAK,CAACG,GAHA;AAIXU,YAAAA,MAAM,EAAEb,KAAK,CAACa;AAJH,WAAb;AAMD;AACF;AACF;AAjDH;;AAAA;AAAA","sourcesContent":["const colCache = require('../utils/col-cache');\nconst Anchor = require('./anchor');\n\nmodule.exports = class Image {\n  constructor(worksheet, model) {\n    this.worksheet = worksheet;\n    this.model = model;\n  }\n\n  get model() {\n    switch (this.type) {\n      case 'background':\n        return {\n          type: this.type,\n          imageId: this.imageId,\n        };\n      case 'image':\n        return {\n          type: this.type,\n          imageId: this.imageId,\n          range: {\n            tl: this.range.tl.model,\n            br: this.range.br && this.range.br.model,\n            ext: this.range.ext,\n          },\n        };\n      default:\n        throw new Error('Invalid Image Type');\n    }\n  }\n\n  set model({ type, imageId, range }) {\n    this.type = type;\n    this.imageId = imageId;\n\n    if (type === 'image') {\n      if (typeof range === 'string') {\n        const decoded = colCache.decode(range);\n        this.range = {\n          tl: new Anchor(this.worksheet, { col: decoded.left, row: decoded.top }, -1),\n          br: new Anchor(this.worksheet, { col: decoded.right, row: decoded.bottom }, 0),\n          editAs: 'oneCell',\n        };\n      } else {\n        this.range = {\n          tl: new Anchor(this.worksheet, range.tl, 0),\n          br: range.br && new Anchor(this.worksheet, range.br, 0),\n          ext: range.ext,\n          editAs: range.editAs,\n        };\n      }\n    }\n  }\n};\n"],"file":"image.js"}